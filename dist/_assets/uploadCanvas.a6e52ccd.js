let t=document.createElement("style");t.innerHTML=".bord[data-v-514072a6]{box-sizing:border-box}.bord .detail[data-v-514072a6]{box-sizing:border-box;position:relative;border:1px solid #999;margin-bottom:20px}.bord .detail .mark[data-v-514072a6]{width:70%;height:70%;box-sizing:border-box;border:1px solid #999;background:rgba(0,0,0,.2);position:absolute}.bord .btns[data-v-514072a6]{display:flex;flex-direction:row;justify-content:space-around;position:relative}.bord .btns .input[data-v-514072a6]{width:80px;height:40px;position:absolute;left:0;opacity:0;overflow:hidden}.bord .btns button[data-v-514072a6]{width:80px;height:40px;background-color:#faebd7;display:flex;justify-content:center;align-items:center}.test .img img[data-v-3bfdcc0e]{width:200px;height:200px}",document.head.appendChild(t);import{n as e,b as a,r as i,t as n,p as o,q as c,c as l,d as s,e as r,s as d,h as u,x as m,g as h}from"./index.1d5dfa01.js";var g=e({emits:["transmit"],setup(t,{emit:e}){let o=document.documentElement.clientWidth,c=o,l=.7*c;console.log(o,c,l);const s=a({cW:c,cH:c,mW:l,mH:l,mL:(c-l)/2,mT:(c-l)/2,showMark:!1,iW:0,iH:0,iL:0,iT:0,IMAGE:null,CTX:null,curX:0,curY:0,newDataUrl:null});let r=i(null);let d=i(null);const u=()=>{s.CTX=d.value.getContext("2d"),s.CTX.clearRect(0,0,s.cW,s.cH),s.CTX.drawImage(s.IMAGE,s.iL,s.iT,s.iW,s.iH)};return{...n(s),fileOnchange:t=>{s.showMark=!0;let e=r.value.files[0];if(!e)return;let a=new FileReader;a.readAsDataURL(e),a.onload=t=>{s.IMAGE=new Image,s.IMAGE.src=t.target.result,s.IMAGE.onload=()=>{if(s.iW=s.IMAGE.width,s.iH=s.IMAGE.height,s.iW>s.cW){let t=s.iW/s.cW;s.iW=s.cW,s.iH=s.iH/t}else if(s.iH>s.cH){let t=s.iH/s.cH;s.iH=s.cH,s.iW=s.iW/t}s.iL=(s.cW-s.iW)/2,s.iT=(s.cW-s.iW)/2,u()}}},uploadfile:r,changeImage:t=>{if(!s.IMAGE)return;let e=20/(s.iW/s.iH);t?(s.iW+=20,s.iH+=e):(s.iW-=20,s.iH-=e),u()},touchstart:t=>{s.IMAGE&&(s.curX=t.touches[0].clientX,s.curY=t.touches[0].clientY)},touchmove:t=>{if(!s.IMAGE)return;let e=t.touches[0].clientX-s.curX,a=t.touches[0].clientY-s.curY;s.iL=s.iL+e,s.iT=s.iT+a,u(),s.curX=t.touches[0].clientX,s.curY=t.touches[0].clientY},keepSave:()=>{if(!s.IMAGE)return;let t=s.CTX.getImageData(s.mL,s.mT,s.mW,s.mH),a=document.createElement("canvas");a.width=s.mW,a.height=s.mH,a.getContext("2d").putImageData(t,0,0,0,0,s.mW,s.mH),s.newDataUrl=a.toDataURL("image/png"),e("transmit",s.newDataUrl)},canvas:d}}});o("data-v-514072a6");const p={class:"bord"},b=["width","height"],v={class:"btns"},f={class:"input"},x=r("button",null,"选择图片",-1);c(),g.render=function(t,e,a,i,n,o){return l(),s("div",p,[r("div",{class:"detail",onTouchstart:e[0]||(e[0]=(...e)=>t.touchstart&&t.touchstart(...e)),onTouchmove:e[1]||(e[1]=(...e)=>t.touchmove&&t.touchmove(...e))},[r("canvas",{width:t.cW,height:t.cH,ref:"canvas"},null,8,b),t.showMark?(l(),s("div",{key:0,class:"mark",style:d({width:t.mW+"px",height:t.mH+"px",left:t.mL+"px",top:t.mT+"px"})},null,4)):u("",!0)],32),r("div",v,[r("div",f,[r("input",{type:"file",accept:"image/*",ref:"uploadfile",onChange:e[2]||(e[2]=(...e)=>t.fileOnchange&&t.fileOnchange(...e))},null,544)]),x,r("button",{onClick:e[3]||(e[3]=e=>t.changeImage(1))},"放大"),r("button",{onClick:e[4]||(e[4]=e=>t.changeImage(0))},"缩小"),r("button",{onClick:e[5]||(e[5]=(...e)=>t.keepSave&&t.keepSave(...e))},"保存图片")])])},g.__scopeId="data-v-514072a6";var W={components:{ClipImage:g},setup(){const t=a({showImg:!1,dataUrl:""});return{...n(t),transmit:e=>{e&&(t.showImg=!0,t.dataUrl=e)}}}};o("data-v-3bfdcc0e");const I={class:"test"},w={key:1,class:"img"},H=["src"];c(),W.render=function(t,e,a,i,n,o){const c=m("ClipImage");return l(),s("div",I,[t.showImg?u("",!0):(l(),h(c,{key:0,onTransmit:i.transmit},null,8,["onTransmit"])),t.showImg?(l(),s("div",w,[r("img",{src:t.dataUrl,alt:""},null,8,H)])):u("",!0)])},W.__scopeId="data-v-3bfdcc0e";export{W as default};
