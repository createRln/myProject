import{x as c,y as a,z as o,M as d,P as p,a0 as f,H as h,ad as b,a2 as _,B as m,C as u}from"./@vue.c3bb5eb1.js";import{_ as x}from"./index.0c3764fc.js";import"./vue-router.c336efea.js";import"./element-plus.12733ec3.js";import"./lodash.81388c16.js";import"./dayjs.d38e4417.js";import"./@vueuse.149d5305.js";import"./@element-plus.f66b6848.js";import"./@popperjs.7a88ba6a.js";import"./@ctrl.2e36ce53.js";import"./async-validator.5d25c98b.js";import"./memoize-one.4ee5c96d.js";import"./normalize-wheel-es.9a219a59.js";const v={data(){return{ws:null,count:0,userId:null,list:[],contentText:""}},created(){this.getUserID()},mounted(){this.initWebSocket()},methods:{getUserID(){let e=new Date().getTime();this.userId=e},getUserHead(e,t){let s=String(e);if(t=="bck")return Number(s.substring(s.length-3));if(t=="polygon")return Number(s.substring(s.length-2));if(t=="rotate")return Number(s.substring(s.length-3))},scrollBottm(){let e=this.$refs["msg-box"];e.scrollTop=e.scrollHeight},sendText(){let e=this;if(e.$refs.sendMsg.focus(),!e.contentText)return;let t={userId:e.userId,msg:e.contentText};e.ws.send(JSON.stringify(t)),e.contentText="",setTimeout(()=>{e.scrollBottm()},500)},initWebSocket(){let e=this;if(window.WebSocket){let t=new WebSocket("ws://10.2.23.234:8181");e.ws=t,t.onopen=function(s){console.log("\u670D\u52A1\u5668\u8FDE\u63A5\u6210\u529F")},t.onclose=function(s){console.log("\u670D\u52A1\u5668\u8FDE\u63A5\u5173\u95ED")},t.onerror=function(){console.log("\u670D\u52A1\u5668\u8FDE\u63A5\u51FA\u9519")},t.onmessage=function(s){let l=JSON.parse(s.data);l.funName=="userCount"?(e.count=l.users,e.list=l.chat,console.log(l.chat)):e.list=[...e.list,{userId:l.userId,content:l.msg}]}}}}},I={class:"chat-box"},y={class:"msg-box",ref:"msg-box"},j={class:"user-head"},w={class:"user-msg"},T={class:"input-box"};function k(e,t,s,l,n,i){return c(),a("div",I,[o("header",null,"\u804A\u5929\u5BA4\u4EBA\u6570\uFF1A"+d(n.count),1),o("div",y,[(c(!0),a(p,null,f(n.list,(r,g)=>(c(),a("div",{key:g,class:"msg",style:u(r.userId==n.userId?"flex-direction:row-reverse":"")},[o("div",j,[o("div",{class:"head",style:u(` background: hsl(${i.getUserHead(r.userId,"bck")}, 88%, 62%); clip-path:polygon(${i.getUserHead(r.userId,"polygon")}% 0,100% 100%,0% 100%); transform: rotate(${i.getUserHead(r.userId,"rotate")}deg)`)},null,4)]),o("div",w,[o("span",{style:u(r.userId==n.userId?" float: right;":""),class:m(r.userId==n.userId?"right":"left")},d(r.content),7)])],4))),128))],512),o("div",T,[h(o("input",{type:"text",ref:"sendMsg","onUpdate:modelValue":t[0]||(t[0]=r=>n.contentText=r),onKeyup:t[1]||(t[1]=_(r=>i.sendText(),["enter"]))},null,544),[[b,n.contentText]]),o("div",{class:m(["btn",{["btn-active"]:n.contentText}]),onClick:t[2]||(t[2]=r=>i.sendText())},"\u53D1\u9001",2)])])}var V=x(v,[["render",k],["__scopeId","data-v-101cbcb8"]]);export{V as default};
