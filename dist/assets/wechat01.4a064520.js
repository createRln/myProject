import{o as c,c as u,k as r,l as a,F as m,x as h,s as _,v as b,I as x,G as g,z as d}from"./vendor.b123f8a6.js";import{_ as p}from"./index.abeff2d8.js";const v={data(){return{ws:null,count:0,userId:null,list:[],contentText:""}},created(){this.getUserID()},mounted(){this.initWebSocket()},methods:{getUserID(){let e=new Date().getTime();this.userId=e},getUserHead(e,t){let s=String(e);if(t=="bck")return Number(s.substring(s.length-3));if(t=="polygon")return Number(s.substring(s.length-2));if(t=="rotate")return Number(s.substring(s.length-3))},scrollBottm(){let e=this.$refs["msg-box"];e.scrollTop=e.scrollHeight},sendText(){let e=this;if(e.$refs.sendMsg.focus(),!e.contentText)return;let t={userId:e.userId,msg:e.contentText};e.ws.send(JSON.stringify(t)),e.contentText="",setTimeout(()=>{e.scrollBottm()},500)},initWebSocket(){let e=this;if(window.WebSocket){let t=new WebSocket("ws://10.2.23.234:8181");e.ws=t,t.onopen=function(s){console.log("\u670D\u52A1\u5668\u8FDE\u63A5\u6210\u529F")},t.onclose=function(s){console.log("\u670D\u52A1\u5668\u8FDE\u63A5\u5173\u95ED")},t.onerror=function(){console.log("\u670D\u52A1\u5668\u8FDE\u63A5\u51FA\u9519")},t.onmessage=function(s){let l=JSON.parse(s.data);l.funName=="userCount"?(e.count=l.users,e.list=l.chat,console.log(l.chat)):e.list=[...e.list,{userId:l.userId,content:l.msg}]}}}}},I={class:"chat-box"},w={class:"msg-box",ref:"msg-box"},T={class:"user-head"},y={class:"user-msg"},k={class:"input-box"};function S(e,t,s,l,o,i){return c(),u("div",I,[r("header",null,"\u804A\u5929\u5BA4\u4EBA\u6570\uFF1A"+a(o.count),1),r("div",w,[(c(!0),u(m,null,h(o.list,(n,f)=>(c(),u("div",{key:f,class:"msg",style:d(n.userId==o.userId?"flex-direction:row-reverse":"")},[r("div",T,[r("div",{class:"head",style:d(` background: hsl(${i.getUserHead(n.userId,"bck")}, 88%, 62%); clip-path:polygon(${i.getUserHead(n.userId,"polygon")}% 0,100% 100%,0% 100%); transform: rotate(${i.getUserHead(n.userId,"rotate")}deg)`)},null,4)]),r("div",y,[r("span",{style:d(n.userId==o.userId?" float: right;":""),class:g(n.userId==o.userId?"right":"left")},a(n.content),7)])],4))),128))],512),r("div",k,[_(r("input",{type:"text",ref:"sendMsg","onUpdate:modelValue":t[0]||(t[0]=n=>o.contentText=n),onKeyup:t[1]||(t[1]=x(n=>i.sendText(),["enter"]))},null,544),[[b,o.contentText]]),r("div",{class:g(["btn",{["btn-active"]:o.contentText}]),onClick:t[2]||(t[2]=n=>i.sendText())},"\u53D1\u9001",2)])])}var U=p(v,[["render",S],["__scopeId","data-v-101cbcb8"]]);export{U as default};
